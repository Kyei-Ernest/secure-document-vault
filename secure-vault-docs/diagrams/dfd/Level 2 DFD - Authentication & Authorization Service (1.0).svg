<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2566px" preserveAspectRatio="none" style="width:3003px;height:2566px;background:#FFFFFF;" version="1.1" viewBox="0 0 3003 2566" width="3003px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="459" x="1265.265" y="22.9951">Level 2 DFD - Authentication &amp; Authorization Service (1.0)</text><!--entity User--><g id="elem_User"><ellipse cx="718.53" cy="1249.8369" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M718.53,1257.8369 L718.53,1284.8369 M705.53,1265.8369 L731.53,1265.8369 M718.53,1284.8369 L705.53,1299.8369 M718.53,1284.8369 L731.53,1299.8369 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="702.53" y="1314.332">User</text></g><!--entity Admin--><g id="elem_Admin"><ellipse cx="2287.53" cy="1249.8369" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M2287.53,1257.8369 L2287.53,1284.8369 M2274.53,1265.8369 L2300.53,1265.8369 M2287.53,1284.8369 L2274.53,1299.8369 M2287.53,1284.8369 L2300.53,1299.8369 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="2266.03" y="1314.332">Admin</text></g><!--entity MFAProvider--><g id="elem_MFAProvider"><path d="M2032.53,934.5169 C2032.53,924.5169 2096.53,924.5169 2096.53,924.5169 C2096.53,924.5169 2160.53,924.5169 2160.53,934.5169 L2160.53,976.1106 C2160.53,986.1106 2096.53,986.1106 2096.53,986.1106 C2096.53,986.1106 2032.53,986.1106 2032.53,976.1106 L2032.53,934.5169 " fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><path d="M2032.53,934.5169 C2032.53,944.5169 2096.53,944.5169 2096.53,944.5169 C2096.53,944.5169 2160.53,944.5169 2160.53,934.5169 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88" x="2042.53" y="961.512">External MFA</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="108" x="2042.53" y="977.8089">Provider (TOTP)</text></g><!--entity DocMgmt--><g id="elem_DocMgmt"><rect fill="#90EE90" height="52.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188" x="882.53" y="2415.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="892.53" y="2438.042">2.0</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="168" x="892.53" y="2454.3389">Document Management</text></g><!--entity Audit--><g id="elem_Audit"><rect fill="#90EE90" height="52.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="1759.03" y="2415.0469"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="1769.03" y="2438.042">4.0</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="1769.03" y="2454.3389">Audit Service</text></g><!--entity CredValidator--><g id="elem_CredValidator"><rect fill="#FFFFE0" height="68.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="2310.53" y="361.7169"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="2320.53" y="384.712">1.1</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="70" x="2320.53" y="401.0089">Credential</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="2320.53" y="417.3057">Validator</text></g><!--entity MFAValidator--><g id="elem_MFAValidator"><rect fill="#FFFFE0" height="68.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="79" x="1399.03" y="595.8869"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="1409.03" y="618.882">1.2</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="29" x="1409.03" y="635.1789">MFA</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="1409.03" y="651.4757">Validator</text></g><!--entity TokenGen--><g id="elem_TokenGen"><rect fill="#FFFFE0" height="68.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="129" x="1286.03" y="920.8669"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="1296.03" y="943.862">1.3</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="1296.03" y="960.1589">Token</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="1296.03" y="976.4557">Generator (JWT)</text></g><!--entity TokenValidator--><g id="elem_TokenValidator"><rect fill="#FFFFE0" height="68.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="79" x="482.03" y="1899.0369"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="492.03" y="1922.032">1.4</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44" x="492.03" y="1938.3289">Token</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59" x="492.03" y="1954.6257">Validator</text></g><!--entity SessionMgr--><g id="elem_SessionMgr"><rect fill="#FFFFE0" height="68.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80" x="821.53" y="1409.6369"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="831.53" y="1432.632">1.5</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="55" x="831.53" y="1448.9289">Session</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="831.53" y="1465.2257">Manager</text></g><!--entity AuthZ--><g id="elem_AuthZ"><rect fill="#FFFFE0" height="68.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="872.03" y="2145.3969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="882.03" y="2168.392">1.6</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="882.03" y="2184.6889">Authorization</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111" x="882.03" y="2200.9857">Enforcer (RBAC)</text></g><!--entity CredDB--><g id="elem_CredDB"><path d="M2508.03,601.3869 C2508.03,591.3869 2584.53,591.3869 2584.53,591.3869 C2584.53,591.3869 2661.03,591.3869 2661.03,601.3869 L2661.03,659.2775 C2661.03,669.2775 2584.53,669.2775 2584.53,669.2775 C2584.53,669.2775 2508.03,669.2775 2508.03,659.2775 L2508.03,601.3869 " fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><path d="M2508.03,601.3869 C2508.03,611.3869 2584.53,611.3869 2584.53,611.3869 C2584.53,611.3869 2661.03,611.3869 2661.03,601.3869 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="2518.03" y="628.382">D1.1: User</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="78" x="2518.03" y="644.6789">Credentials</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="133" x="2518.03" y="660.9757">(Password Hashes)</text></g><!--entity MFADB--><g id="elem_MFADB"><path d="M1102.53,934.5169 C1102.53,924.5169 1176.53,924.5169 1176.53,924.5169 C1176.53,924.5169 1250.53,924.5169 1250.53,934.5169 L1250.53,976.1106 C1250.53,986.1106 1176.53,986.1106 1176.53,986.1106 C1176.53,986.1106 1102.53,986.1106 1102.53,976.1106 L1102.53,934.5169 " fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><path d="M1102.53,934.5169 C1102.53,944.5169 1176.53,944.5169 1176.53,944.5169 C1176.53,944.5169 1250.53,944.5169 1250.53,934.5169 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="1112.53" y="961.512">D1.2: MFA Secrets</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96" x="1112.53" y="977.8089">(TOTP Seeds)</text></g><!--entity SessionDB--><g id="elem_SessionDB"><path d="M947.03,1701.5269 C947.03,1691.5269 998.53,1691.5269 998.53,1691.5269 C998.53,1691.5269 1050.03,1691.5269 1050.03,1701.5269 L1050.03,1743.1206 C1050.03,1753.1206 998.53,1753.1206 998.53,1753.1206 C998.53,1753.1206 947.03,1753.1206 947.03,1743.1206 L947.03,1701.5269 " fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><path d="M947.03,1701.5269 C947.03,1711.5269 998.53,1711.5269 998.53,1711.5269 C998.53,1711.5269 1050.03,1711.5269 1050.03,1701.5269 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="957.03" y="1728.522">D1.3: Active</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63" x="957.03" y="1744.8189">Sessions</text></g><!--entity RoleDB--><g id="elem_RoleDB"><path d="M1281.03,2420.5469 C1281.03,2410.5469 1339.53,2410.5469 1339.53,2410.5469 C1339.53,2410.5469 1398.03,2410.5469 1398.03,2420.5469 L1398.03,2462.1406 C1398.03,2472.1406 1339.53,2472.1406 1339.53,2472.1406 C1339.53,2472.1406 1281.03,2472.1406 1281.03,2462.1406 L1281.03,2420.5469 " fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><path d="M1281.03,2420.5469 C1281.03,2430.5469 1339.53,2430.5469 1339.53,2430.5469 C1339.53,2430.5469 1398.03,2430.5469 1398.03,2420.5469 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97" x="1291.03" y="2447.542">D1.4: Roles &amp;</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="1291.03" y="2463.8389">Permissions</text></g><!--entity BlacklistDB--><g id="elem_BlacklistDB"><path d="M384.53,1701.5269 C384.53,1691.5269 437.53,1691.5269 437.53,1691.5269 C437.53,1691.5269 490.53,1691.5269 490.53,1701.5269 L490.53,1743.1206 C490.53,1753.1206 437.53,1753.1206 437.53,1753.1206 C437.53,1753.1206 384.53,1753.1206 384.53,1743.1206 L384.53,1701.5269 " fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><path d="M384.53,1701.5269 C384.53,1711.5269 437.53,1711.5269 437.53,1711.5269 C437.53,1711.5269 490.53,1711.5269 490.53,1701.5269 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86" x="394.53" y="1728.522">D1.5: Token</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="394.53" y="1744.8189">Blacklist</text></g><g id="elem_GMN77"><path d="M2770.53,307.9269 L2770.53,392.1569 L2400.91,396.1569 L2770.53,400.1569 L2770.53,484.3878 A0,0 0 0 0 2770.53,484.3878 L2996.53,484.3878 A0,0 0 0 0 2996.53,484.3878 L2996.53,317.9269 L2986.53,307.9269 L2770.53,307.9269 A0,0 0 0 0 2770.53,307.9269 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2986.53,307.9269 L2986.53,317.9269 L2996.53,317.9269 L2986.53,307.9269 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="2776.53" y="324.9938">Password Security:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="2776.53" y="340.1266">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="2776.53" y="355.2594">Algorithm: Argon2id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="2776.53" y="370.3922">- Memory: 64 MB</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="2776.53" y="385.525">- Iterations: 3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="2776.53" y="400.6578">- Parallelism: 4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="2776.53" y="415.7906">- Salt: 16 bytes (unique)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="2776.53" y="430.9235">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="2776.53" y="446.0563">Alternative: bcrypt (cost 12+)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="2776.53" y="461.1891">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205" x="2776.53" y="476.3219">Never store plaintext passwords</text></g><g id="elem_GMN80"><path d="M1772.03,776.2869 L1772.03,951.3069 L1415.46,955.3069 L1772.03,959.3069 L1772.03,1134.3416 A0,0 0 0 0 1772.03,1134.3416 L1997.03,1134.3416 A0,0 0 0 0 1997.03,1134.3416 L1997.03,786.2869 L1987.03,776.2869 L1772.03,776.2869 A0,0 0 0 0 1772.03,776.2869 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1987.03,776.2869 L1987.03,786.2869 L1997.03,786.2869 L1987.03,776.2869 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="1778.03" y="793.3538">JWT Structure:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1778.03" y="808.4866">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="1778.03" y="823.6194">Header:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1778.03" y="838.7522">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="1786.03" y="853.885">"alg": "HS256",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="1786.03" y="869.0178">"typ": "JWT"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1778.03" y="884.1506">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1778.03" y="899.2835">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="1778.03" y="914.4163">Payload:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1778.03" y="929.5491">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="1786.03" y="944.6819">"sub": "user_id",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="1786.03" y="959.8147">"role": "admin",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196" x="1786.03" y="974.9475">"permissions": ["read", "write"],</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="1786.03" y="990.0803">"exp": 1708099800,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="1786.03" y="1005.2131">"iat": 1708099200,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1786.03" y="1020.346">"jti": "token_uuid"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1778.03" y="1035.4788">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="1778.03" y="1050.6116">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166" x="1778.03" y="1065.7444">Signature: HMACSHA256(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="1786.03" y="1080.8772">base64(header) + "." +</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="1786.03" y="1096.01">base64(payload),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="40" x="1786.03" y="1111.1428">secret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="1778.03" y="1126.2756">)</text></g><g id="elem_GMN83"><path d="M638.03,2322.8469 L638.03,2559.8391 L847.03,2559.8391 L847.03,2332.8469 L837.03,2322.8469 L638.03,2322.8469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M837.03,2322.8469 L837.03,2332.8469 L847.03,2332.8469 L837.03,2322.8469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="644.03" y="2339.9138">RBAC Hierarchy:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="644.03" y="2355.0466">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="644.03" y="2370.1794">SuperAdmin (all permissions)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="644.03" y="2385.3122">&#9500;&#9472;&#9472; Admin</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="644.03" y="2400.445">&#9474;   &#9500;&#9472;&#9472; Manager</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="644.03" y="2415.5778">&#9474;   &#9474;   &#9500;&#9472;&#9472; User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="644.03" y="2430.7106">&#9474;   &#9474;   &#9492;&#9472;&#9472; ReadOnly</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="644.03" y="2445.8435">&#9474;   &#9492;&#9472;&#9472; Auditor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="644.03" y="2460.9763">&#9492;&#9472;&#9472; SystemAccount</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="644.03" y="2476.1091">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138" x="644.03" y="2491.2419">Permissions checked:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="644.03" y="2506.3747">1. Role-based (RBAC)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="644.03" y="2521.5075">2. Resource ownership</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="644.03" y="2536.6403">3. Explicit sharing</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="644.03" y="2551.7731">4. Time-based access</text></g><g id="elem_GMN86"><path d="M912.53,1830.1169 L912.53,2036.8434 A0,0 0 0 0 912.53,2036.8434 L1116.53,2036.8434 A0,0 0 0 0 1116.53,2036.8434 L1116.53,1840.1169 L1106.53,1830.1169 L1010.68,1830.1169 L1000.82,1753.2869 L1002.68,1830.1169 L912.53,1830.1169 A0,0 0 0 0 912.53,1830.1169 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1106.53,1830.1169 L1106.53,1840.1169 L1116.53,1840.1169 L1106.53,1830.1169 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="918.53" y="1847.1838">Session Management:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="918.53" y="1862.3166">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="918.53" y="1877.4494">- Max concurrent: 3 sessions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165" x="918.53" y="1892.5822">- Idle timeout: 15 minutes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="918.53" y="1907.715">- Absolute timeout: 8 hours</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="918.53" y="1922.8478">- IP pinning (optional)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="918.53" y="1937.9806">- Device fingerprinting</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4" x="918.53" y="1953.1135">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="918.53" y="1968.2463">Invalidate on:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="918.53" y="1983.3791">- Password change</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="918.53" y="1998.5119">- Role change</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="918.53" y="2013.6447">- Manual logout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="918.53" y="2028.7775">- Admin revocation</text></g><!--link User to CredValidator--><g id="link_User_CredValidator"><path d="M702.23,1255.9469 C693.54,1243.2669 683.11,1226.8969 675.53,1211.3369 C659.65,1178.7369 655.99,1169.8269 648.53,1134.3369 C419.17,43.2969 585.81,738.1869 618.53,699.2869 C844.49,430.6269 2054.0105,400.9357 2304.4105,397.6457 " fill="none" id="User-to-CredValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2310.41,397.5669,2301.3582,393.6855,2305.4104,397.6326,2301.4633,401.6848,2310.41,397.5669" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="619.53" y="719.8538">Username/Email</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="642.53" y="734.9866">Password</text></g><!--link Admin to CredValidator--><g id="link_Admin_CredValidator"><path d="M2283.79,1241.0269 C2275.27,1148.6169 2257.01,902.4469 2281.53,699.2869 C2293.5,600.0969 2325.0068,492.2063 2342.5668,436.8163 " fill="none" id="Admin-to-CredValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2344.38,431.0969,2337.8472,438.4673,2342.869,435.8631,2345.4732,440.8849,2344.38,431.0969" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="2282.53" y="727.3538">Admin Credentials</text></g><!--link CredValidator to CredDB--><g id="link_CredValidator_CredDB"><path d="M2381.54,431.0069 C2399.52,454.4269 2423.99,486.2969 2445.53,514.3869 C2461.54,535.2669 2462.28,543.4569 2481.53,561.3869 C2492.89,571.9769 2501.1312,578.6243 2514.2012,587.5843 " fill="none" id="CredValidator-to-CredDB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2519.15,590.9769,2513.9886,582.5888,2515.026,588.1497,2509.4651,589.1872,2519.15,590.9769" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="2489.53" y="534.9538">Query User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="2482.53" y="550.0866">by Username</text></g><!--link CredDB to CredValidator--><g id="link_CredDB_CredValidator"><path d="M2589.55,591.1469 C2590.71,567.2069 2588.4,536.7669 2573.53,514.3869 C2533.58,454.2569 2457.9477,424.2204 2406.7077,409.5304 " fill="none" id="CredDB-to-CredValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2400.94,407.8769,2408.4891,414.2023,2405.7464,409.2548,2410.6938,406.5121,2400.94,407.8769" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="2614.3" y="527.4538">User Record</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="2589.8" y="542.5866">(ID, Password Hash,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="2612.3" y="557.7194">Role, Status)</text></g><!--link CredValidator to CredValidator--><g id="link_CredValidator_CredValidator"><path d="M2400.77,382.9869 C2419.58,382.0869 2435.53,386.4769 2435.53,396.1569 C2435.53,405.8469 2425.573,410.5268 2406.763,409.6168 " fill="none" id="CredValidator-to-CredValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2400.77,409.3269,2409.5662,413.7571,2405.7642,409.5685,2409.9528,405.7664,2400.77,409.3269" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="2454.53" y="370.7238">Verify Password:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="2455.53" y="385.8566">Argon2id.Verify(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="2469.03" y="400.9894">stored_hash,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="2449.53" y="416.1222">provided_password</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5" x="2504.03" y="431.255">)</text></g><!--link CredValidator to CredValidator--><g id="link_CredValidator_CredValidator"><path d="M2400.91,377.3669 C2468.49,362.5969 2577.53,368.8569 2577.53,396.1569 C2577.53,423.4669 2474.3516,431.008 2406.7716,416.238 " fill="none" id="CredValidator-to-CredValidator-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2400.91,414.9569,2408.8484,420.7863,2405.7947,416.0245,2410.5565,412.9708,2400.91,414.9569" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145" x="2583.53" y="378.2238">Check Account Status:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="2628.53" y="393.3566">- Active?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="2625.53" y="408.4894">- Locked?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="2624.53" y="423.6222">- Expired?</text></g><!--link CredValidator to MFAValidator--><g id="link_CredValidator_MFAValidator"><path d="M2310.06,408.6769 C2151.95,448.7069 1633.5165,579.9742 1484.2965,617.7542 " fill="none" id="CredValidator-to-MFAValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1478.48,619.2269,1488.1865,620.8956,1483.3271,617.9997,1486.223,613.1403,1478.48,619.2269" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47" x="1890.54" y="534.9538">User ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="1870.54" y="550.0866">MFA Required</text></g><!--link CredValidator to Audit--><g id="link_CredValidator_Audit"><path d="M2372.72,430.7869 C2393.73,475.0969 2426.53,555.9969 2426.53,629.3369 C2186.53,2559.8369 2186.53,2559.8369 2426.53,2180.8469 C2426.53,2301.4669 2024.8028,2396.6878 1874.3428,2428.1778 " fill="none" id="CredValidator-to-Audit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1868.47,2429.4069,1878.0985,2431.4784,1873.364,2428.3826,1876.4597,2423.648,1868.47,2429.4069" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="2444.03" y="1441.1438">Log Failed Login</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="2427.53" y="1456.2766">(if invalid credentials)</text></g><!--link MFAValidator to MFADB--><g id="link_MFAValidator_MFADB"><path d="M1398.7,635.6369 C1331.68,643.7969 1200.97,663.9169 1173.53,699.2869 C1122.37,765.2269 1146.2965,866.6302 1163.4565,918.5302 " fill="none" id="MFAValidator-to-MFADB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1165.34,924.2269,1166.3125,914.4261,1163.7704,919.4796,1158.7169,916.9375,1165.34,924.2269" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="1174.53" y="719.8538">Get MFA Secret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="1199.03" y="734.9866">for User</text></g><!--link MFADB to MFAValidator--><g id="link_MFADB_MFAValidator"><path d="M1190.43,924.4469 C1218.68,864.7069 1283.21,733.2769 1319.53,699.2869 C1342.72,677.5769 1368.6778,662.6268 1393.3778,650.8068 " fill="none" id="MFADB-to-MFAValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1398.79,648.2169,1388.945,648.4937,1394.2798,650.3752,1392.3983,655.71,1398.79,648.2169" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1320.53" y="719.8538">TOTP Secret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="1322.53" y="734.9866">(encrypted)</text></g><!--link MFAValidator to User--><g id="link_MFAValidator_User"><path d="M1398.7,631.9969 C1256.43,635.3569 777.92,655.5869 704.53,776.2869 C612.99,926.8269 672.699,1146.7961 702.779,1235.2861 " fill="none" id="MFAValidator-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="704.71,1240.9669,705.6006,1231.1584,703.1008,1236.2329,698.0263,1233.7331,704.71,1240.9669" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="705.53" y="959.8738">Request TOTP Code</text></g><!--link User to MFAValidator--><g id="link_User_MFAValidator"><path d="M716.45,1241.0769 C717.1,1216.4469 722.08,1185.0569 740.53,1164.3369 C769.98,1131.2769 803.42,1164.8169 835.53,1134.3369 C958.78,1017.3669 852.82,899.7669 969.53,776.2869 C1087.05,651.9469 1302.6617,633.6212 1392.8517,631.4512 " fill="none" id="User-to-MFAValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1398.85,631.3069,1389.7564,627.5245,1393.8514,631.4271,1389.9488,635.5222,1398.85,631.3069" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="970.53" y="959.8738">6-digit TOTP Code</text></g><!--link MFAValidator to MFAProvider--><g id="link_MFAValidator_MFAProvider"><path d="M1478.42,644.5569 C1549.52,667.7369 1703.13,716.1269 1835.53,746.2869 C1914.18,764.1969 1950.44,727.2969 2014.53,776.2869 C2062.25,812.7569 2081.9331,877.6816 2090.3131,918.1416 " fill="none" id="MFAValidator-to-MFAProvider" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2091.53,924.0169,2093.6215,914.3927,2090.5159,919.1208,2085.7878,916.0152,2091.53,924.0169" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="1855.03" y="712.3538">Validate TOTP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125" x="1836.53" y="727.4866">(Time-based check,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97" x="1850.53" y="742.6194">30-sec window)</text></g><!--link MFAProvider to MFAValidator--><g id="link_MFAProvider_MFAValidator"><path d="M2091.28,924.1269 C2079.81,868.5069 2046.83,750.8269 1966.53,699.2869 C1885.55,647.2969 1592.918,635.0821 1484.338,632.2721 " fill="none" id="MFAProvider-to-MFAValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1478.34,632.1169,1487.2335,636.3484,1483.3383,632.2462,1487.4405,628.3511,1478.34,632.1169" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="2017.53" y="727.3538">Valid/Invalid</text></g><!--link MFAValidator to MFAValidator--><g id="link_MFAValidator_MFAValidator"><path d="M1478.39,613.3469 C1496.88,611.4969 1513.03,617.1569 1513.03,630.3369 C1513.03,643.5169 1502.8502,649.7742 1484.3602,647.9242 " fill="none" id="MFAValidator-to-MFAValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1478.39,647.3269,1486.9471,652.203,1483.3652,647.8247,1487.7435,644.2428,1478.39,647.3269" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134" x="1519.03" y="627.4038">Check Backup Codes</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="1545.03" y="642.5366">(if TOTP fails)</text></g><!--link MFAValidator to TokenGen--><g id="link_MFAValidator_TokenGen"><path d="M1429.36,664.9869 C1412.46,727.0269 1378.1473,852.9579 1361.2573,914.9479 " fill="none" id="MFAValidator-to-TokenGen" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1359.68,920.7369,1365.9052,913.1049,1360.9944,915.9127,1358.1866,911.0019,1359.68,920.7369" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84" x="1420.52" y="719.8538">MFA Success</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="1421.52" y="734.9866">User ID, Role</text></g><!--link MFAValidator to Audit--><g id="link_MFAValidator_Audit"><path d="M1478.5,631.9569 C1604.26,634.4469 1990.11,646.3169 2101.53,699.2869 C2213.34,752.4369 2213.53,830.5169 2213.53,954.3069 C2186.53,2559.8369 2186.53,2559.8369 2213.53,2180.8469 C2213.53,2343.5069 1983.7444,2408.1748 1874.1944,2429.9948 " fill="none" id="MFAValidator-to-Audit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1868.31,2431.1669,1877.918,2433.3317,1873.2137,2430.1902,1876.3553,2425.4859,1868.31,2431.1669" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="2214.53" y="1582.0938">Log Failed MFA</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="2231.53" y="1597.2266">(if invalid)</text></g><!--link TokenGen to RoleDB--><g id="link_TokenGen_RoleDB"><path d="M1415.49,989.7369 C1502.62,1039.7569 1646.53,1142.9069 1646.53,1278.4869 C2186.53,2559.8369 2186.53,2559.8369 1646.53,1586.0269 C1646.53,1661.2469 1654.18,1680.4269 1673.53,1753.1169 C1682.94,1788.4569 1695.98,1794.1369 1702.53,1830.1169 C1718.99,1920.5069 1719.34,1946.5169 1702.53,2036.8469 C1686.94,2120.6669 1674.91,2141.2969 1633.53,2215.8469 C1612.74,2253.3069 1607.12,2263.8969 1575.53,2292.8469 C1521.57,2342.3069 1454.1398,2382.0829 1403.7398,2408.6029 " fill="none" id="TokenGen-to-RoleDB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1398.43,2411.3969,1408.2573,2410.7458,1402.8548,2409.0686,1404.532,2403.6661,1398.43,2411.3969" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="1674.53" y="1719.3838">Get User Roles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="1676.03" y="1734.5166">&amp; Permissions</text></g><!--link RoleDB to TokenGen--><g id="link_RoleDB_TokenGen"><path d="M1347.17,2410.1269 C1354.69,2380.3269 1366.48,2333.4669 1376.53,2292.8469 C1461.84,1947.9969 1553,1863.0569 1530.53,1508.5269 C1522.96,1389.0569 1531.91,1355.6969 1496.53,1241.3369 C1466.71,1144.9369 1409.0109,1047.019 1376.0709,995.249 " fill="none" id="RoleDB-to-TokenGen" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1372.85,990.1869,1374.3066,999.9274,1375.5341,994.4054,1381.0562,995.6328,1372.85,990.1869" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53" x="1553.83" y="1719.3838">Role List</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="1532.33" y="1734.5166">Permission Set</text></g><!--link TokenGen to TokenGen--><g id="link_TokenGen_TokenGen"><path d="M1415.13,933.5469 C1434.72,934.0869 1450.03,941.3469 1450.03,955.3069 C1450.03,969.2769 1440.7176,976.3585 1421.1276,976.9085 " fill="none" id="TokenGen-to-TokenGen" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1415.13,977.0769,1424.2387,980.8227,1420.128,976.9366,1424.0142,972.8259,1415.13,977.0769" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="1463.53" y="884.3738">Generate JWT:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="1477.03" y="899.5066">Payload {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="1489.03" y="914.6394">user_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35" x="1494.53" y="929.7722">email</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24" x="1500.03" y="944.905">role</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="1473.53" y="960.0378">permissions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="1474.53" y="975.1706">exp: 15 min</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="16" x="1504.03" y="990.3035">iat</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="1473.03" y="1005.4363">jti (token ID)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1504.03" y="1020.5691">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="1456.03" y="1035.7019">Sign with HS256</text></g><!--link TokenGen to TokenGen--><g id="link_TokenGen_TokenGen"><path d="M1410.28,920.4369 C1476.66,901.6169 1566.03,913.2469 1566.03,955.3069 C1566.03,997.3769 1482.4327,1010.6327 1416.0527,991.8227 " fill="none" id="TokenGen-to-TokenGen-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1410.28,990.1869,1417.8485,996.4891,1415.0906,991.55,1420.0296,988.7921,1410.28,990.1869" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158" x="1572.03" y="914.8738">Generate Refresh Token:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62" x="1620.03" y="930.0066">Payload {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="1632.03" y="945.1394">user_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="1618.53" y="960.2722">exp: 7 days</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="11" x="1649.53" y="975.405">jti</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="1647.03" y="990.5378">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="1599.03" y="1005.6706">Sign with HS256</text></g><!--link TokenGen to SessionMgr--><g id="link_TokenGen_SessionMgr"><path d="M1338.7,990.1469 C1324.89,1027.2669 1299.88,1087.7569 1268.53,1134.3369 C1185.08,1258.3169 1163.47,1297.6269 1038.53,1379.6369 C995.96,1407.5769 945.3721,1423.5768 907.7921,1432.9368 " fill="none" id="TokenGen-to-SessionMgr" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="901.97,1434.3869,911.6699,1436.0931,906.8218,1433.1785,909.7365,1428.3303,901.97,1434.3869" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="1203.54" y="1269.0538">Store Session</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="1196.04" y="1284.1866">Access Token ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="1194.54" y="1299.3194">Refresh Token ID</text></g><!--link TokenGen to SessionMgr--><g id="link_TokenGen_SessionMgr"><path d="M1358.02,990.2069 C1371.38,1060.4069 1390.94,1223.0069 1310.53,1317.6369 C1256.88,1380.7769 1007.7684,1422.2991 907.7984,1436.7391 " fill="none" id="TokenGen-to-SessionMgr-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="901.86,1437.5969,911.3394,1440.2692,906.8086,1436.8821,910.1957,1432.3513,901.86,1437.5969" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="1369.6" y="1276.5538">Update Session</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="1352.6" y="1291.6866">New Access Token ID</text></g><!--link SessionMgr to SessionDB--><g id="link_SessionMgr_SessionDB"><path d="M821.48,1451.1169 C765.28,1460.4969 667.5,1480.4669 646.53,1508.5269 C605.82,1562.9869 602.66,1609.5669 646.53,1661.5269 C651.37,1667.2569 844.0701,1697.5726 940.7701,1712.4826 " fill="none" id="SessionMgr-to-SessionDB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="946.7,1713.3969,938.4147,1708.0721,941.7584,1712.6349,937.1956,1715.9787,946.7,1713.3969" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="654.03" y="1521.5938">Create Session:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="700.53" y="1536.7266">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="685.53" y="1551.8594">user_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="656.03" y="1566.9922">access_token_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="655.53" y="1582.125">refresh_token_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="674.03" y="1597.2578">ip_address</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="672.53" y="1612.3906">user_agent</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="674.03" y="1627.5235">created_at</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66" x="675.53" y="1642.6563">expires_at</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="700.53" y="1657.7891">}</text></g><!--link SessionMgr to SessionDB--><g id="link_SessionMgr_SessionDB"><path d="M821.55,1478.9469 C813.8,1487.7069 806.77,1497.7469 802.53,1508.5269 C777.65,1571.8069 762.07,1606.8769 802.53,1661.5269 C835.45,1705.9869 894.7124,1718.1115 940.8624,1721.0815 " fill="none" id="SessionMgr-to-SessionDB-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="946.85,1721.4669,938.1255,1716.8971,941.8603,1721.1458,937.6117,1724.8806,946.85,1721.4669" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136" x="803.53" y="1589.5938">Check Active Session</text></g><!--link SessionDB to SessionMgr--><g id="link_SessionDB_SessionMgr"><path d="M1050.36,1720.6269 C1140.55,1718.1969 1320.5,1707.5569 1359.53,1661.5269 C1403.51,1609.6569 1404.47,1559.5569 1359.53,1508.5269 C1329.36,1474.2669 1021.0505,1453.9245 907.8605,1447.5445 " fill="none" id="SessionDB-to-SessionMgr" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="901.87,1447.2069,910.6306,1451.707,906.8621,1447.4883,911.0808,1443.7197,901.87,1447.2069" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="1393.88" y="1589.5938">Session Valid/Invalid</text></g><!--link SessionMgr to SessionDB--><g id="link_SessionMgr_SessionDB"><path d="M902,1467.6869 C917.45,1478.2169 933.89,1492.0769 944.53,1508.5269 C982.5,1567.1669 962.46,1594.0469 980.53,1661.5269 C983.14,1671.2669 984.4876,1676.0754 987.3676,1685.5654 " fill="none" id="SessionMgr-to-SessionDB-2" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="989.11,1691.3069,990.324,1681.5331,987.658,1686.5223,982.6688,1683.8563,989.11,1691.3069" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="981.53" y="1589.5938">Query Session</text></g><!--link SessionDB to SessionMgr--><g id="link_SessionDB_SessionMgr"><path d="M946.66,1712.9469 C906.55,1706.6169 849.6,1697.9569 799.53,1691.5269 C737.46,1683.5569 561.36,1708.0669 519.53,1661.5269 C474.08,1610.9469 476.06,1560.8069 519.53,1508.5269 C557.52,1462.8469 733.1356,1450.1663 815.1656,1446.6163 " fill="none" id="SessionDB-to-SessionMgr-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="821.16,1446.3569,811.9955,1442.7497,816.1647,1446.5731,812.3414,1450.7423,821.16,1446.3569" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85" x="520.53" y="1589.5938">Session Data</text></g><!--link SessionMgr to SessionDB--><g id="link_SessionMgr_SessionDB"><path d="M901.95,1451.0569 C958.67,1460.3769 1057.35,1480.2569 1078.53,1508.5269 C1119.31,1562.9369 1108.99,1600.7269 1078.53,1661.5269 C1072.16,1674.2369 1066.4329,1681.288 1055.1029,1689.968 " fill="none" id="SessionMgr-to-SessionDB-3" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1050.34,1693.6169,1059.917,1691.3188,1054.3091,1690.5761,1055.0518,1684.9682,1050.34,1693.6169" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="1106.39" y="1589.5938">Update Session</text></g><!--link SessionMgr to SessionDB--><g id="link_SessionMgr_SessionDB"><path d="M901.82,1446.0569 C986.14,1449.0369 1176.75,1460.9969 1216.53,1508.5269 C1260.18,1560.6669 1257.77,1607.4569 1216.53,1661.5269 C1196.48,1687.8169 1114.3095,1704.49 1056.4295,1713.44 " fill="none" id="SessionMgr-to-SessionDB-4" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1050.5,1714.3569,1060.0056,1716.9346,1055.4413,1713.5928,1058.783,1709.0285,1050.5,1714.3569" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="1249.36" y="1589.5938">Delete Session</text></g><!--link TokenGen to User--><g id="link_TokenGen_User"><path d="M1345.52,990.1969 C1337.37,1031.8869 1316.98,1101.1969 1268.53,1134.3369 C1177.57,1196.5469 865.03,1102.9169 773.53,1164.3369 C759.79,1173.5669 745.3475,1205.7944 733.9975,1235.4044 " fill="none" id="TokenGen-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="731.85,1241.0069,738.8063,1234.0348,733.6396,1236.3381,731.3363,1231.1714,731.85,1241.0069" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="818.53" y="1177.4038">Access Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="817.03" y="1192.5366">Refresh Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175" x="774.53" y="1207.6694">(HTTPOnly, Secure cookies)</text></g><!--link TokenGen to User--><g id="link_TokenGen_User"><path d="M1345.19,990.1969 C1336.74,1031.5469 1316.05,1100.1669 1268.53,1134.3369 C1167.63,1206.8769 1098.85,1103.4169 990.53,1164.3369 C967.6,1177.2369 976.29,1196.5369 954.53,1211.3369 C882.67,1260.2069 781.4576,1273.3085 740.8676,1276.8285 " fill="none" id="TokenGen-to-User-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="734.89,1277.3469,744.2019,1280.5543,739.8713,1276.9149,743.5108,1272.5843,734.89,1277.3469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="991.53" y="1192.4038">New Access Token</text></g><!--link TokenGen to Admin--><g id="link_TokenGen_Admin"><path d="M1411.35,990.1969 C1488.6,1031.5469 1627.21,1100.1569 1754.53,1134.3369 C1872.42,1165.9869 1909.62,1132.7669 2027.53,1164.3369 C2052.24,1170.9469 2202.2566,1239.3348 2260.2766,1265.9548 " fill="none" id="TokenGen-to-Admin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="2265.73,1268.4569,2259.2179,1261.0682,2261.1855,1266.3718,2255.8818,1268.3394,2265.73,1268.4569" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="2157.02" y="1184.9038">Admin Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="2140.52" y="1200.0366">(Higher privileges)</text></g><!--link TokenGen to Audit--><g id="link_TokenGen_Audit"><path d="M1415.32,986.6769 C1494.58,1023.4069 1633.21,1086.2769 1754.53,1134.3369 C1791.78,1149.0869 1803.91,1146.0069 1839.53,1164.3369 C1918.18,1204.7969 2002.53,1190.0469 2002.53,1278.4869 C2186.53,2559.8369 2186.53,2559.8369 2002.53,2180.8469 C2002.53,2283.3969 1909.6535,2368.9388 1854.7335,2410.9988 " fill="none" id="TokenGen-to-Audit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1849.97,2414.6469,1859.5474,2412.3504,1853.9396,2411.6068,1854.6832,2405.999,1849.97,2414.6469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133" x="2015.03" y="1719.3838">Log Successful Login</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="2003.53" y="1734.5166">(User ID, IP, Timestamp)</text></g><!--link TokenGen to Audit--><g id="link_TokenGen_Audit"><path d="M1415.4,969.5969 C1542.82,999.8869 1813.53,1086.7969 1813.53,1278.4869 C2186.53,2559.8369 2186.53,2559.8369 1813.53,2180.8469 C1813.53,2266.4469 1813.53,2361.9269 1813.53,2408.5569 " fill="none" id="TokenGen-to-Audit-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1813.53,2414.5569,1817.53,2405.5569,1813.53,2409.5569,1809.53,2405.5569,1813.53,2414.5569" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="1814.53" y="1726.8838">Log Token Refresh</text></g><!--link DocMgmt to TokenValidator--><g id="link_DocMgmt_TokenValidator"><path d="M957.75,2414.5969 C937.39,2388.3269 902.67,2347.9369 864.53,2322.8469 C832.46,2301.7369 815.03,2314.7869 783.53,2292.8469 C658.48,2205.7269 572.8544,2044.7913 539.1944,1973.5913 " fill="none" id="DocMgmt-to-TokenValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="536.63,1968.1669,536.8603,1978.013,538.767,1972.6872,544.0928,1974.5939,536.63,1968.1669" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63" x="731.12" y="2176.9138">JWT Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="695.12" y="2192.0466">Requested Operation</text></g><!--link TokenValidator to TokenValidator--><g id="link_TokenValidator_TokenValidator"><path d="M561.39,1920.4469 C579.88,1919.0269 596.03,1923.3669 596.03,1933.4769 C596.03,1943.5969 585.8624,1948.3963 567.3724,1946.9763 " fill="none" id="TokenValidator-to-TokenValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="561.39,1946.5169,570.0573,1951.1943,566.3753,1946.8997,570.6699,1943.2178,561.39,1946.5169" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="602.03" y="1923.0438">Verify JWT Signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="612.53" y="1938.1766">Check Expiration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="604.03" y="1953.3094">Check Token ID (jti)</text></g><!--link TokenValidator to TokenValidator--><g id="link_TokenValidator_TokenValidator"><path d="M561.36,1915.5369 C625.92,1899.6569 735.03,1905.6369 735.03,1933.4769 C735.03,1961.3269 631.7463,1968.74 567.1863,1952.86 " fill="none" id="TokenValidator-to-TokenValidator-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="561.36,1951.4269,569.1441,1957.4608,566.2153,1952.6211,571.0549,1949.6923,561.36,1951.4269" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="741.03" y="1938.0438">Verify Refresh Token</text></g><!--link TokenValidator to BlacklistDB--><g id="link_TokenValidator_BlacklistDB"><path d="M527,1898.6869 C530.46,1866.9869 531.27,1819.1969 512.53,1783.1169 C506.62,1771.7369 502.0668,1765.6648 492.1768,1757.3248 " fill="none" id="TokenValidator-to-BlacklistDB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="487.59,1753.4569,491.8916,1762.3167,491.4124,1756.6802,497.0489,1756.2009,487.59,1753.4569" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122" x="519.92" y="1796.1838">Check if Blacklisted</text></g><!--link BlacklistDB to TokenValidator--><g id="link_BlacklistDB_TokenValidator"><path d="M384.23,1743.3469 C375.33,1746.6469 366.18,1749.9969 357.53,1753.1169 C319.45,1766.8469 294.97,1750.1169 271.53,1783.1169 C267.16,1789.2769 267.64,1793.6469 271.53,1800.1169 C317.38,1876.2669 417.5311,1909.5257 475.7011,1923.2857 " fill="none" id="BlacklistDB-to-TokenValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="481.54,1924.6669,473.7025,1918.7025,476.6743,1923.5159,471.8609,1926.4877,481.54,1924.6669" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="272.53" y="1796.1838">Blacklist Status</text></g><!--link TokenValidator to BlacklistDB--><g id="link_TokenValidator_BlacklistDB"><path d="M561.27,1912.3969 C611.47,1884.3469 687.17,1831.4469 650.53,1783.1169 C631.28,1757.7069 553.3517,1741.0731 496.7817,1731.8431 " fill="none" id="TokenValidator-to-BlacklistDB-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="490.86,1730.8769,499.0984,1736.274,495.7947,1731.682,500.3867,1728.3784,490.86,1730.8769" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="659.95" y="1796.1838">Check Blacklist</text></g><!--link BlacklistDB to TokenValidator--><g id="link_BlacklistDB_TokenValidator"><path d="M415.04,1753.5069 C407.28,1767.6169 401.8,1784.6869 407.53,1800.1169 C422.31,1839.9269 450.5911,1871.7291 477.2011,1896.0491 " fill="none" id="BlacklistDB-to-TokenValidator-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="481.63,1900.0969,477.6851,1891.0726,477.9392,1896.7237,472.2881,1896.9778,481.63,1900.0969" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95" x="408.53" y="1796.1838">Not Blacklisted</text></g><!--link TokenValidator to SessionMgr--><g id="link_TokenValidator_SessionMgr"><path d="M481.55,1925.4269 C421.52,1912.4569 309.89,1878.6069 260.53,1800.1169 C226.04,1745.2569 219.63,1556.1969 263.53,1508.5269 C285.25,1484.9369 518.65,1481.9069 550.53,1478.5269 C647.74,1468.2169 756.0349,1456.5129 815.3149,1450.0929 " fill="none" id="TokenValidator-to-SessionMgr" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="821.28,1449.4469,811.9016,1446.4392,816.3091,1449.9852,812.763,1454.3927,821.28,1449.4469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106" x="243.65" y="1726.8838">Validate Session</text></g><!--link TokenValidator to SessionMgr--><g id="link_TokenValidator_SessionMgr"><path d="M561.4,1925.5569 C642.99,1909.5569 816.99,1864.9669 763.53,1783.1169 C690.01,1670.5469 560.05,1774.0869 486.53,1661.5269 C449.35,1604.5969 442.64,1560.4669 486.53,1508.5269 C508.03,1483.0869 722.5804,1458.9397 815.0704,1449.5997 " fill="none" id="TokenValidator-to-SessionMgr-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="821.04,1448.9969,811.6837,1445.9214,816.0653,1449.4992,812.4874,1453.8809,821.04,1448.9969" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93" x="738.09" y="1719.3838">Check Session</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46" x="761.59" y="1734.5166">Validity</text></g><!--link TokenValidator to AuthZ--><g id="link_TokenValidator_AuthZ"><path d="M561.42,1957.9169 C635.44,2001.3969 789.1364,2091.6781 874.8064,2141.9981 " fill="none" id="TokenValidator-to-AuthZ" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="879.98,2145.0369,874.2455,2137.0296,875.6687,2142.5045,870.1938,2143.9277,879.98,2145.0369" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73" x="857.96" y="2079.9138">Token Valid</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77" x="855.96" y="2095.0466">User Claims</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="826.96" y="2110.1794">Requested Operation</text></g><!--link TokenValidator to Audit--><g id="link_TokenValidator_Audit"><path d="M561.51,1946.0269 C629.77,1965.6069 773.27,2006.1769 895.53,2036.8469 C1102.91,2088.8569 1163.05,2072.3269 1364.53,2143.8469 C1376.61,2148.1369 1560.8,2238.8369 1571.53,2245.8469 C1598.75,2263.5969 1602.36,2272.3069 1627.53,2292.8469 C1680.7,2336.2269 1738.6641,2381.8702 1775.9941,2411.0702 " fill="none" id="TokenValidator-to-Audit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1780.72,2414.7669,1776.0956,2406.0712,1776.7817,2411.6863,1771.1666,2412.3725,1780.72,2414.7669" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109" x="1514.82" y="2176.9138">Log Invalid Token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="1513.82" y="2192.0466">(if validation fails)</text></g><!--link AuthZ to RoleDB--><g id="link_AuthZ_RoleDB"><path d="M1003.29,2188.1269 C1081.42,2197.9069 1205.83,2217.4169 1242.53,2245.8469 C1270.42,2267.4469 1307.1672,2355.6703 1326.1072,2404.6803 " fill="none" id="AuthZ-to-RoleDB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1328.27,2410.2769,1328.7568,2400.4401,1326.4676,2405.613,1321.2947,2403.3238,1328.27,2410.2769" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88" x="1278.1" y="2266.4138">Get User Role</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92" x="1276.1" y="2281.5466">&amp; Permissions</text></g><!--link RoleDB to AuthZ--><g id="link_RoleDB_AuthZ"><path d="M1296.59,2410.2969 C1255.12,2381.0069 1190.78,2334.8569 1136.53,2292.8469 C1110.57,2272.7369 1107.36,2263.2669 1079.53,2245.8469 C1055.75,2230.9569 1033.4878,2219.8799 1008.8478,2209.1099 " fill="none" id="RoleDB-to-AuthZ" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1003.35,2206.7069,1009.9946,2213.9766,1007.9315,2208.7094,1013.1987,2206.6463,1003.35,2206.7069" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96" x="1137.53" y="2273.9138">Permission Set</text></g><!--link AuthZ to AuthZ--><g id="link_AuthZ_AuthZ"><path d="M1003.26,2171.4769 C1022.82,2171.7269 1038.03,2174.5169 1038.03,2179.8469 C1038.03,2185.1769 1028.8195,2187.8902 1009.2595,2188.1402 " fill="none" id="AuthZ-to-AuthZ" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1003.26,2188.2169,1012.3104,2192.1015,1008.2596,2188.153,1012.2081,2184.1022,1003.26,2188.2169" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="1049.53" y="2161.9138">Check Permission:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128" x="1044.03" y="2177.0466">Does user role have</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="1044.53" y="2192.1794">required permission</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89" x="1063.53" y="2207.3122">for operation?</text></g><!--link AuthZ to AuthZ--><g id="link_AuthZ_AuthZ"><path d="M1003.29,2166.3069 C1076.85,2159.2269 1178.03,2163.7369 1178.03,2179.8469 C1178.03,2195.9469 1082.8224,2201.0417 1009.2624,2193.9617 " fill="none" id="AuthZ-to-AuthZ-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1003.29,2193.3869,1011.8654,2198.2307,1008.267,2193.8659,1012.6318,2190.2675,1003.29,2193.3869" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="1192.03" y="2169.4138">Resource-level Check:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="1185.03" y="2184.5466">Does user own resource</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="1184.03" y="2199.6794">OR have shared access?</text></g><!--link AuthZ to DocMgmt--><g id="link_AuthZ_DocMgmt"><path d="M871.82,2195.2469 C844.58,2204.8069 815.63,2220.4669 799.53,2245.8469 C788.34,2263.4869 788.27,2275.2469 799.53,2292.8469 C816.68,2319.6469 838.65,2304.3369 864.53,2322.8469 C901.44,2349.2369 932.4617,2384.2298 953.2017,2410.0398 " fill="none" id="AuthZ-to-DocMgmt" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="956.96,2414.7169,954.4406,2405.1957,953.8281,2410.8193,948.2045,2410.2068,956.96,2414.7169" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69" x="844.03" y="2266.4138">Authorized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="800.53" y="2281.5466">(proceed with operation)</text></g><!--link AuthZ to DocMgmt--><g id="link_AuthZ_DocMgmt"><path d="M952.05,2214.7269 C955.73,2224.5869 959.27,2235.5069 961.53,2245.8469 C974.56,2305.3969 976.6608,2371.3569 976.7808,2408.8369 " fill="none" id="AuthZ-to-DocMgmt-1" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="976.8,2414.8369,980.7712,2405.8241,976.784,2409.8369,972.7712,2405.8497,976.8,2414.8369" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86" x="977.34" y="2266.4138">Unauthorized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="969.84" y="2281.5466">(403 Forbidden)</text></g><!--link AuthZ to Audit--><g id="link_AuthZ_Audit"><path d="M1003.31,2182.3069 C1091.15,2186.0869 1250.42,2199.4069 1377.53,2245.8469 C1414.84,2259.4769 1418.15,2274.8069 1453.53,2292.8469 C1558.24,2346.2069 1681.2766,2393.1391 1752.9766,2419.0291 " fill="none" id="AuthZ-to-Audit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1758.62,2421.0669,1751.5135,2414.248,1753.9172,2419.3687,1748.7965,2421.7725,1758.62,2421.0669" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112" x="1454.53" y="2258.9138">Log Authorization</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="1483.53" y="2274.0466">Decision</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="1455.03" y="2289.1794">(Granted/Denied)</text></g><!--link User to TokenValidator--><g id="link_User_TokenValidator"><path d="M702.05,1280.2069 C618.01,1279.8069 235.22,1290.2669 81.53,1508.5269 C6,1615.7969 34.93,1707.1769 127.53,1800.1169 C226.72,1899.6669 397.0381,1923.8916 475.7181,1930.0116 " fill="none" id="User-to-TokenValidator" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="481.7,1930.4769,473.0373,1925.791,476.7151,1930.0891,472.4169,1933.7669,481.7,1930.4769" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="82.53" y="1589.5938">Refresh Token</text></g><!--link TokenValidator to TokenGen--><g id="link_TokenValidator_TokenGen"><path d="M481.97,1923.5669 C422.57,1908.2269 310.33,1871.3969 244.53,1800.1169 C200.48,1752.3869 183.43,1558.8169 224.53,1508.5269 C364.31,1337.5169 493.57,1445.3369 711.53,1409.6369 C817.62,1392.2569 852.99,1422.5769 951.53,1379.6369 C1039.25,1341.4069 1042.85,1302.3869 1116.53,1241.3369 C1158.12,1206.8769 1165.41,1194.0169 1210.53,1164.3369 C1234.78,1148.3869 1248.49,1155.3269 1268.53,1134.3369 C1308.14,1092.8769 1329.4854,1034.6371 1340.5754,995.7271 " fill="none" id="TokenValidator-to-TokenGen" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1342.22,989.9569,1335.9063,997.5158,1340.8495,994.7654,1343.5999,999.7086,1342.22,989.9569" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="712.53" y="1441.1438">Generate New</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="714.53" y="1456.2766">Access Token</text></g><!--link User to SessionMgr--><g id="link_User_SessionMgr"><path d="M734.81,1287.1869 C757.37,1297.2269 798.1,1318.1969 822.53,1347.6369 C837.39,1365.5369 845.4458,1384.1452 851.5158,1403.7552 " fill="none" id="User-to-SessionMgr" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="853.29,1409.4869,854.4499,1399.7066,851.8115,1404.7105,846.8076,1402.0721,853.29,1409.4869" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100" x="842.57" y="1360.7038">Logout Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="849.07" y="1375.8366">Access Token</text></g><!--link SessionMgr to User--><g id="link_SessionMgr_User"><path d="M821.22,1438.3069 C785.63,1431.7169 735.75,1416.1669 711.53,1379.6369 C699.62,1361.6569 699.6767,1343.4469 704.2167,1323.5269 " fill="none" id="SessionMgr-to-User" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="705.55,1317.6769,699.6501,1325.563,704.4389,1322.5519,707.4501,1327.3407,705.55,1317.6769" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101" x="712.53" y="1368.2038">Logout Success</text></g><!--link SessionMgr to BlacklistDB--><g id="link_SessionMgr_BlacklistDB"><path d="M821.08,1449.4469 C692.07,1463.3869 298.73,1506.0669 296.53,1508.5269 C251.21,1559.2169 258.99,1604.8269 296.53,1661.5269 C299.23,1665.5969 339.7509,1682.4741 378.5109,1698.0141 " fill="none" id="SessionMgr-to-BlacklistDB" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="384.08,1700.2469,377.2149,1693.185,379.4391,1698.3862,374.2379,1700.6104,384.08,1700.2469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="297.53" y="1582.0938">Add Token to Blacklist</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="315.53" y="1597.2266">(until expiration)</text></g><!--link SessionMgr to Audit--><g id="link_SessionMgr_Audit"><path d="M901.73,1445.9769 C1039.52,1449.4369 1486.7,1464.0269 1531.53,1508.5269 C1699.05,1674.8069 1513.96,1811.9269 1585.53,2036.8469 C1611.24,2117.6369 1745.9288,2333.7985 1793.8788,2409.4785 " fill="none" id="SessionMgr-to-Audit" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1797.09,2414.5469,1795.652,2404.8036,1794.414,2410.3233,1788.8943,2409.0852,1797.09,2414.5469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="1586.53" y="1938.0438">Log Logout Event</text></g><!--link AuthZ to GMN83--><g id="link_AuthZ_GMN83"><path d="M871.69,2193.7569 C840.62,2203.1469 805.6,2219.0869 783.53,2245.8469 C765.69,2267.4769 755.05,2294.9669 748.83,2322.4269 " fill="none" id="AuthZ-GMN83" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/></g><!--SRC=[bLZlRkEu4V-kfvYwm9wDZRs9aytjwKCNJfn_HRAR9jahsge8Q8cnUP59bwAI-0uB7FeC-x5FTq_IuP2IASNnvG07aOOSpl_V3FMdZDy9oU7gwF1czEda_0ZId1L551bXSWxd_87dC8JnyHZwC2hDZ4iZKcQ4al2624gBdztxDTSF8kNGtHbizwBeEpXwCbnBbiCHCXd1YuYbHcdeV2cuxW0hm3vKn54s5vAez1HbpB09ApXqwdCkZaU9lDJgGMHSG_VcyyrbZpXmeI97cgU6oIbgtnaEjXCvLcavHxNXWaasvVQHU91-CPqR-FEvcCxCYUPSXhnxbdTKPi9KXZdTY1BoeA7NvQI_q2hbHO561eVi37OIUQXvPjt6yaJ-o7A1XYbdlbsfAVxGV_0yLu_DGuQ99DERt4Xw3VDk8c_KFPU9FE6IQzhT_UlVRvpdQ0aNDXomLn_Gb4_4rsZmFf7Nw1hC4RI3Wk0EyCIBwIRcVHk58CqIUIJlb4vj0bmTZ0vxFYnczi_cAHYNCQOGNADo69LLEeqnAZ6bNXYR8f7TIqpzHwKpE6N5Z1UzEaZZWoR_CBRUHmDIpOtbjAc8hpmhweHiy-p6C4gDUE2rDuhG2-tjUp5SgPmNy0PJdkkv25ZiGdl_-nXyb0vobjxded1fNhyX0xhaN4s5X6Fh8Ei1wFV_qaf3vnh9vlpTqPm9JDhABH4LvbeMjn9uCugQMogcyG7k_bl9zT97OBAivKL-mqiwmHLFKGrqzzbu2nh1sagaTSeMHfkPikYz93uyyaUknTsoFYV6HDDJ9OSY6xYbRY812fi-sUtC2G5OE9p9RXUUBv6ladOuu-azPa2gIiGYfoQAxFka-6WVprLwppDwF7fQ23pXuxgZ6uNlNNCs9en05_sdj8nhs1nqnJO5u1W3opEN3UXFSGT2FjZTaAvYI21k3wLqQKZrQb0qJxW9gY6nrUc0tMrOex6l5hUzosMgbml3CvJtJ0WP5vDPl32Eyr1bV9MzhRFt-vcOYd3dMithBe9vuDOuiTXQ5dFUjtM5ph11mx3lRlSBdiAZa9bwx4KX_neLwFdTcNFeUl7FC-C0oxHSaCQ5YmXPS8U1AjOvfWPk3qLbQjjF8dqsR158F6TRamJKMe8KeB3JyU0xXktkb0ErK7kKGo6V0Au-BM0byWq4W1NvRIsTBHNE4PP2TCESC55JIC3YbU60pIksgBJC5SlW5rkL9Og_5Pbzv0wq03IAe8fTAKFhJuiOTjx3t6O-W636_ll92EWQClfit4laLqHfCPKOSZE3q-lX-_rNA7R5xx3LpDpQ9XMj2jz3nfQ5b_qAWK6tZ5rJWxghZYZuFcWM2XgQ82MA0lRWD8eVGeNLtfDGxxQ-Z8w_9VTuadO26ZInk6LPfYaDFJ_sUad-JKb6TkkypGdT2dhxshBJLtneKiiUpDRJcvlBpp9VRbaOAT4LgLBtE67sccUvjbIrfvePfmIKiT3Y0GjWQhbQR46H-CAwA_CQBUiIExlS0eiMXM7pHL0slkIgie6kXKJEqXcwZN2i5rNJPvrA8I9WWgyC9mOiqyyBNufUsJLmiAQxsQDiNc6xqLWD3ckekVXfob6gF84k9cDlhOHWaAX12q6Z9cFF2RUiLQhUu1lWMa6DHA_1sLCtvh5liRQVjlTxZPf5v5xQUBr69JTUnc5uFT8UvapCYzV7AKmjBx7EI_JcmofpAkJ_hdNDSXb5es_az7ePZ3TWSMLI6trNHrOxd5jN-s9xfyB1r1OuWIpCc9rgjHyz0i1rmu2gFF9ntV5Nl50bplFzd2wR9AqXGZrAh1ktAP6VhqWS53DcPJbeQXnSbLPSEuxRcP4kQCX105khr5lB-4Moa7LlUnUEbPw834UZNjE8LJXRrvGnJuNpGVT4CucfyMxCfU1XVwrWhJcFFokR1lhzaUflClvkiRb8rrs5TWgpt5HpRfJ_0yLcxsIlnfUQzllGyacP1XQzwAPMp_x47vlzSrFR_R88iIYHo0ojthl9MKtszNslVUI6rjJ88N-vKwLfPLF30B_3erNRy9RgpOYCCezKODHg2RCRxpCYTotTbzGc7unvpaCVjBPwBtWzVVDzjYlqWjzwz82JHXH9XOTh-na0r5tp4XR1wiv8KmEcTen4_8toALQkcStHJ7y7H6eVBlXSwILUAlRWue0ePyO3Hn73Bb4kcMPvpj4PoBr7f6kM6vmnzs6oD8XYw261_kvLikXhbcrICKpewWFTL65Ft1c-zNi-8HHgT_M41NOOH8yd0zMDiuYupC1QshQtIXKyWXg_qMLg6xytyvGplBBObr_m3w33ycadXWwDcvqjHpFBXQKXVmS9NnsddsG3rgASs6r-IgoORJkmP4OVypmn6C1nxLyT70MH0JgFw7BU-RVVXGc4gplVRt_O_k673zlRdepp-OeyhCaufbWvRlmiIzHWfMmzxyHmUZ4wl3uTeNbTuhFNklszxemSqOEtq1bqu6suj72MzfoSWYwf-DXh-toYZ55pwtJg1hZ5jcGu5PWVEfrLcNLTelLk_EnYceIN4HlhtxxzxxTll-BFV_IqbFz2IFSVp8ALvZhTjDkBt_pY5Tffn-Je-HALa7Ai5UrwYT0vzzyeVE1N-hhRCASas1dGVE6loNuQ0HWEwdPkspRNnKmiaBuxi3DdBbAiMjkuXPmYTMy0mLtRTVANtRpwJWPrCrbzqlNknf9bJtWPa5ZUsf9X5sFefn-gtmpd5ODI4JEgQs29HKgBeqcXSdnRRVW0CxJ6irx2GaY9kaDNBIm6iBn7AsDE7xxlS8bhl5OW89A1-FCpdeLzd9myO7WGIcSC6OX6r-7W7GqhMGuvOPlJZN98ymVbFh_NZle_]--></g></svg>