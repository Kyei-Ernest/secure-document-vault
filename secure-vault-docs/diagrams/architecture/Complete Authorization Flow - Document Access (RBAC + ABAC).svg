<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1832.1875px" preserveAspectRatio="none" style="width:2481px;height:1832px;background:#FFFFFF;" version="1.1" viewBox="0 0 2481 1832" width="2481.875px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="16.0417" font-weight="bold" lengthAdjust="spacing" textLength="584.375" x="949.8958" y="32.0777">Complete Authorization Flow - Document Access (RBAC + ABAC)</text><rect fill="#FFFFFF" height="360.472" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="375.8333" y="188.9014"/><rect fill="#FFFFFF" height="98.9982" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="703.5417" y="222.2827"/><rect fill="#FFFFFF" height="98.9982" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="991.1458" y="372.002"/><rect fill="#FFFFFF" height="513.3244" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="1251.25" y="617.0581"/><rect fill="#FFFFFF" height="33.3813" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="1603.0208" y="650.4395"/><rect fill="#FFFFFF" height="33.3813" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="1603.0208" y="989.9821"/><rect fill="#FFFFFF" height="98.9982" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="1804.6875" y="1163.7638"/><rect fill="#FFFFFF" height="98.9982" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="2219.4792" y="1296.1434"/><rect fill="none" height="966.8416" style="stroke:#000000;stroke-width:1.71875;" width="2439.4792" x="34.375" y="488.1877"/><rect fill="none" height="331.5218" style="stroke:#000000;stroke-width:1.71875;" width="637.0833" x="1157.2917" y="701.0083"/><line style="stroke:#181818;stroke-width:0.5729166666666666;stroke-dasharray:5.0,5.0;" x1="67.6042" x2="67.6042" y1="135.8887" y2="1740.1807"/><line style="stroke:#181818;stroke-width:0.5729166666666666;stroke-dasharray:5.0,5.0;" x1="381.5625" x2="381.5625" y1="135.8887" y2="1740.1807"/><line style="stroke:#181818;stroke-width:0.5729166666666666;stroke-dasharray:5.0,5.0;" x1="709.2708" x2="709.2708" y1="135.8887" y2="1740.1807"/><line style="stroke:#181818;stroke-width:0.5729166666666666;stroke-dasharray:5.0,5.0;" x1="996.3021" x2="996.3021" y1="135.8887" y2="1740.1807"/><line style="stroke:#181818;stroke-width:0.5729166666666666;stroke-dasharray:5.0,5.0;" x1="1256.9792" x2="1256.9792" y1="135.8887" y2="1740.1807"/><line style="stroke:#181818;stroke-width:0.5729166666666666;stroke-dasharray:5.0,5.0;" x1="1608.1771" x2="1608.1771" y1="135.8887" y2="1740.1807"/><line style="stroke:#181818;stroke-width:0.5729166666666666;stroke-dasharray:5.0,5.0;" x1="1809.8437" x2="1809.8437" y1="135.8887" y2="1740.1807"/><line style="stroke:#181818;stroke-width:0.5729166666666666;stroke-dasharray:5.0,5.0;" x1="2224.6354" x2="2224.6354" y1="135.8887" y2="1740.1807"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="36.6667" x="45.8333" y="132.1054">User</text><ellipse cx="67.6042" cy="58.2048" fill="#E2E2F0" rx="9.1667" ry="9.1667" style="stroke:#181818;stroke-width:0.5729166666666666;"/><path d="M67.6042,67.3714 L67.6042,98.3089 M52.7083,76.5381 L82.5,76.5381 M67.6042,98.3089 L52.7083,115.4964 M67.6042,98.3089 L82.5,115.4964 " fill="none" style="stroke:#181818;stroke-width:0.5729166666666666;"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="36.6667" x="45.8333" y="1753.9251">User</text><ellipse cx="67.6042" cy="1767.4479" fill="#E2E2F0" rx="9.1667" ry="9.1667" style="stroke:#181818;stroke-width:0.5729166666666666;"/><path d="M67.6042,1776.6146 L67.6042,1807.5521 M52.7083,1785.7812 L82.5,1785.7812 M67.6042,1807.5521 L52.7083,1824.7396 M67.6042,1807.5521 L82.5,1824.7396 " fill="none" style="stroke:#181818;stroke-width:0.5729166666666666;"/><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="112.2917" x="325.4167" y="100.0277"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="96.25" x="333.4375" y="122.9387">API Gateway</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="112.2917" x="325.4167" y="1739.0348"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="96.25" x="333.4375" y="1761.9459">API Gateway</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="114.5833" x="651.9792" y="100.0277"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="98.5417" x="660" y="122.9387">Auth Service</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="114.5833" x="651.9792" y="1739.0348"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="98.5417" x="660" y="1761.9459">Auth Service</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="120.3125" x="936.7187" y="100.0277"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="104.2708" x="944.7396" y="122.9387">RBAC Engine</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="120.3125" x="936.7187" y="1739.0348"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="104.2708" x="944.7396" y="1761.9459">RBAC Engine</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="119.1667" x="1197.3958" y="100.0277"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="103.125" x="1205.4167" y="122.9387">ABAC Engine</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="119.1667" x="1197.3958" y="1739.0348"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="103.125" x="1205.4167" y="1761.9459">ABAC Engine</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="150.1042" x="1533.6979" y="100.0277"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="134.0625" x="1541.7188" y="122.9387">Permission Store</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="150.1042" x="1533.6979" y="1739.0348"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="134.0625" x="1541.7188" y="1761.9459">Permission Store</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="115.7292" x="1752.5521" y="100.0277"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="99.6875" x="1760.5729" y="122.9387">Audit Logger</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="115.7292" x="1752.5521" y="1739.0348"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="99.6875" x="1760.5729" y="1761.9459">Audit Logger</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="161.5625" x="2144.4271" y="100.0277"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="145.5208" x="2152.4479" y="122.9387">Document Service</text><rect fill="#E2E2F0" height="34.7152" rx="2.8646" ry="2.8646" style="stroke:#181818;stroke-width:0.5729166666666666;" width="161.5625" x="2144.4271" y="1739.0348"/><text fill="#000000" font-family="sans-serif" font-size="16.0417" lengthAdjust="spacing" textLength="145.5208" x="2152.4479" y="1761.9459">Document Service</text><rect fill="#FFFFFF" height="360.472" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="375.8333" y="188.9014"/><rect fill="#FFFFFF" height="98.9982" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="703.5417" y="222.2827"/><rect fill="#FFFFFF" height="98.9982" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="991.1458" y="372.002"/><rect fill="#FFFFFF" height="513.3244" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="1251.25" y="617.0581"/><rect fill="#FFFFFF" height="33.3813" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="1603.0208" y="650.4395"/><rect fill="#FFFFFF" height="33.3813" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="1603.0208" y="989.9821"/><rect fill="#FFFFFF" height="98.9982" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="1804.6875" y="1163.7638"/><rect fill="#FFFFFF" height="98.9982" style="stroke:#181818;stroke-width:1.1458333333333333;" width="11.4583" x="2219.4792" y="1296.1434"/><polygon fill="#444444" points="362.0833,184.318,373.5417,188.9014,362.0833,193.4847,366.6667,188.9014" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="67.6042" x2="368.9583" y1="188.9014" y2="188.9014"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="155.8333" x="75.625" y="165.757">GET /documents/{id}</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="209.6875" x="75.625" y="183.0967">Authorization: Bearer &lt;JWT&gt;</text><polygon fill="#444444" points="689.7917,217.6994,701.25,222.2827,689.7917,226.866,694.375,222.2827" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="387.2917" x2="696.6667" y1="222.2827" y2="222.2827"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="88.2292" x="395.3125" y="216.478">Validate JWT</text><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="715" x2="763.125" y1="255.6641" y2="255.6641"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="763.125" x2="763.125" y1="255.6641" y2="270.5599"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="716.1458" x2="763.125" y1="270.5599" y2="270.5599"/><polygon fill="#444444" points="727.6042,265.9766,716.1458,270.5599,727.6042,275.1432,723.0208,270.5599" style="stroke:#444444;stroke-width:1.1458333333333333;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="248.6458" x="723.0208" y="249.8594">Verify signature, expiration, issuer</text><polygon fill="#444444" points="399.8958,316.6976,388.4375,321.2809,399.8958,325.8643,395.3125,321.2809" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="393.0208" x2="708.125" y1="321.2809" y2="321.2809"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="35.5208" x="406.7708" y="298.1365">Valid</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="288.75" x="406.7708" y="315.4762">User claims (sub, role, clearance, attrs)</text><polygon fill="#444444" points="977.3958,367.4186,988.8542,372.002,977.3958,376.5853,981.9792,372.002" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="387.2917" x2="984.2708" y1="372.002" y2="372.002"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="211.9792" x="395.3125" y="348.8576">Check role-based permission</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="112.2917" x="395.3125" y="366.1973">Action = "read"</text><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1002.6042" x2="1050.7292" y1="405.3833" y2="405.3833"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1050.7292" x2="1050.7292" y1="405.3833" y2="420.2791"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1003.75" x2="1050.7292" y1="420.2791" y2="420.2791"/><polygon fill="#444444" points="1015.2083,415.6958,1003.75,420.2791,1015.2083,424.8625,1010.625,420.2791" style="stroke:#444444;stroke-width:1.1458333333333333;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="221.1458" x="1010.625" y="399.5786">Load role &#8594; permission matrix</text><polygon fill="#444444" points="399.8958,466.4168,388.4375,471.0002,399.8958,475.5835,395.3125,471.0002" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="393.0208" x2="995.7292" y1="471.0002" y2="471.0002"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="84.7917" x="406.7708" y="447.8558">RBAC PASS</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="186.7708" x="406.7708" y="465.1955">(role "User" allows "read")</text><path d="M34.375,488.1877 L107.7083,488.1877 L107.7083,496.3607 L96.25,507.819 L34.375,507.819 L34.375,488.1877 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.71875;"/><rect fill="none" height="966.8416" style="stroke:#000000;stroke-width:1.71875;" width="2439.4792" x="34.375" y="488.1877"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" font-weight="bold" lengthAdjust="spacing" textLength="21.7708" x="51.5625" y="503.1601">alt</text><text fill="#000000" font-family="sans-serif" font-size="12.6042" font-weight="bold" lengthAdjust="spacing" textLength="105.4167" x="124.8958" y="502.1788">[RBAC denied]</text><polygon fill="#444444" points="80.2083,544.79,68.75,549.3734,80.2083,553.9567,75.625,549.3734" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="73.3333" x2="380.4167" y1="549.3734" y2="549.3734"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="104.2708" x="87.0833" y="526.229">403 Forbidden</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="121.4583" x="87.0833" y="543.5687">"Insufficient role"</text><line style="stroke:#A80036;stroke-width:2.2916666666666665;" x1="371.25" x2="391.875" y1="539.0609" y2="559.6859"/><line style="stroke:#A80036;stroke-width:2.2916666666666665;" x1="371.25" x2="391.875" y1="559.6859" y2="539.0609"/><line style="stroke:#000000;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="34.375" x2="2473.8542" y1="559.6859" y2="559.6859"/><text fill="#000000" font-family="sans-serif" font-size="12.6042" font-weight="bold" lengthAdjust="spacing" textLength="107.7083" x="40.1042" y="571.3853">[RBAC passed]</text><polygon fill="#444444" points="1237.5,612.4748,1248.9583,617.0581,1237.5,621.6414,1242.0833,617.0581" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="381.5625" x2="1244.375" y1="617.0581" y2="617.0581"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="167.2917" x="389.5833" y="593.9137">Evaluate ABAC policies</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="326.5625" x="389.5833" y="611.2534">Subject + Resource + Action + Environment</text><polygon fill="#444444" points="1589.2708,645.8561,1600.7292,650.4395,1589.2708,655.0228,1593.8542,650.4395" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1262.7083" x2="1596.1458" y1="650.4395" y2="650.4395"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="300.2083" x="1270.7292" y="644.6348">Fetch applicable policies &amp; explicit grants</text><polygon fill="#444444" points="1275.3125,679.2375,1263.8542,683.8208,1275.3125,688.4041,1270.7292,683.8208" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="1268.4375" x2="1607.6042" y1="683.8208" y2="683.8208"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="242.9167" x="1282.1875" y="678.0161">Policies + document permissions</text><path d="M1157.2917,701.0083 L1350.9375,701.0083 L1350.9375,709.1813 L1339.4792,720.6396 L1157.2917,720.6396 L1157.2917,701.0083 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.71875;"/><rect fill="none" height="331.5218" style="stroke:#000000;stroke-width:1.71875;" width="637.0833" x="1157.2917" y="701.0083"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" font-weight="bold" lengthAdjust="spacing" textLength="142.0833" x="1174.4792" y="715.9808">Policy Evaluation</text><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1262.7083" x2="1310.8333" y1="762.194" y2="762.194"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1310.8333" x2="1310.8333" y1="762.194" y2="777.0898"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1263.8542" x2="1310.8333" y1="777.0898" y2="777.0898"/><polygon fill="#444444" points="1275.3125,772.5065,1263.8542,777.0898,1275.3125,781.6732,1270.7292,777.0898" style="stroke:#444444;stroke-width:1.1458333333333333;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="143.2292" x="1270.7292" y="739.0496">Policy 1 - Clearance</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="253.2292" x="1270.7292" y="756.3893">user.clearance &#8805; doc.classification</text><path d="M1549.1667,739.0491 L1549.1667,767.6949 L1771.4583,767.6949 L1771.4583,750.5074 L1760,739.0491 L1549.1667,739.0491 " fill="#FFFFE0" style="stroke:#888888;stroke-width:0.5729166666666666;"/><path d="M1760,739.0491 L1760,750.5074 L1771.4583,750.5074 L1760,739.0491 " fill="#FFFFE0" style="stroke:#888888;stroke-width:0.5729166666666666;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="198.2292" x="1556.0417" y="758.6049">PASS if clearance sufficient</text><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1262.7083" x2="1310.8333" y1="827.8109" y2="827.8109"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1310.8333" x2="1310.8333" y1="827.8109" y2="842.7067"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1263.8542" x2="1310.8333" y1="842.7067" y2="842.7067"/><polygon fill="#444444" points="1275.3125,838.1234,1263.8542,842.7067,1275.3125,847.29,1270.7292,842.7067" style="stroke:#444444;stroke-width:1.1458333333333333;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="161.5625" x="1270.7292" y="804.6665">Policy 2 - Time window</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="191.3542" x="1270.7292" y="822.0062">(for SECRET+ documents)</text><path d="M1487.2917,804.6659 L1487.2917,833.3118 L1724.4792,833.3118 L1724.4792,816.1243 L1713.0208,804.6659 L1487.2917,804.6659 " fill="#FFFFE0" style="stroke:#888888;stroke-width:0.5729166666666666;"/><path d="M1713.0208,804.6659 L1713.0208,816.1243 L1724.4792,816.1243 L1713.0208,804.6659 " fill="#FFFFE0" style="stroke:#888888;stroke-width:0.5729166666666666;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="213.125" x="1494.1667" y="824.2218">PASS if within business hours</text><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1262.7083" x2="1310.8333" y1="893.4277" y2="893.4277"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1310.8333" x2="1310.8333" y1="893.4277" y2="908.3236"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1263.8542" x2="1310.8333" y1="908.3236" y2="908.3236"/><polygon fill="#444444" points="1275.3125,903.7402,1263.8542,908.3236,1275.3125,912.9069,1270.7292,908.3236" style="stroke:#444444;stroke-width:1.1458333333333333;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="205.1042" x="1270.7292" y="870.2834">Policy 3 - Location / Network</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="128.3333" x="1270.7292" y="887.623">(for TOP_SECRET)</text><path d="M1501.0417,870.2828 L1501.0417,898.9286 L1615.625,898.9286 L1615.625,881.7411 L1604.1667,870.2828 L1501.0417,870.2828 " fill="#FFFFE0" style="stroke:#888888;stroke-width:0.5729166666666666;"/><path d="M1604.1667,870.2828 L1604.1667,881.7411 L1615.625,881.7411 L1604.1667,870.2828 " fill="#FFFFE0" style="stroke:#888888;stroke-width:0.5729166666666666;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="90.5208" x="1507.9167" y="889.8386">N/A or PASS</text><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1262.7083" x2="1310.8333" y1="941.7049" y2="941.7049"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1310.8333" x2="1310.8333" y1="941.7049" y2="956.6007"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1263.8542" x2="1310.8333" y1="956.6007" y2="956.6007"/><polygon fill="#444444" points="1275.3125,952.0174,1263.8542,956.6007,1275.3125,961.1841,1270.7292,956.6007" style="stroke:#444444;stroke-width:1.1458333333333333;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="281.875" x="1270.7292" y="935.9002">Policy 4 - Need-to-know / Explicit share</text><polygon fill="#444444" points="1589.2708,985.3988,1600.7292,989.9821,1589.2708,994.5654,1593.8542,989.9821" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1262.7083" x2="1596.1458" y1="989.9821" y2="989.9821"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="318.5417" x="1270.7292" y="984.1774">Check explicit permission for this document</text><polygon fill="#444444" points="1275.3125,1018.7801,1263.8542,1023.3634,1275.3125,1027.9468,1270.7292,1023.3634" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="1268.4375" x2="1607.6042" y1="1023.3634" y2="1023.3634"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="234.8958" x="1282.1875" y="1017.5587">READ explicitly granted (shared)</text><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="1262.7083" x2="1310.8333" y1="1082.1053" y2="1082.1053"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="1310.8333" x2="1310.8333" y1="1082.1053" y2="1097.0011"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="1263.8542" x2="1310.8333" y1="1097.0011" y2="1097.0011"/><polygon fill="#444444" points="1275.3125,1092.4178,1263.8542,1097.0011,1275.3125,1101.5845,1270.7292,1097.0011" style="stroke:#444444;stroke-width:1.1458333333333333;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="101.9792" x="1270.7292" y="1058.9609">Final decision:</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" font-weight="bold" lengthAdjust="spacing" textLength="61.875" x="1377.2917" y="1058.9609">PERMIT</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="236.0417" x="1270.7292" y="1076.3006">(all mandatory policies satisfied)</text><polygon fill="#444444" points="394.1667,1125.7992,382.7083,1130.3825,394.1667,1134.9658,389.5833,1130.3825" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="387.2917" x2="1255.8333" y1="1130.3825" y2="1130.3825"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="173.0208" x="401.0417" y="1124.5778">Authorization GRANTED</text><polygon fill="#444444" points="1790.9375,1159.1805,1802.3958,1163.7638,1790.9375,1168.3472,1795.5208,1163.7638" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="381.5625" x2="1797.8125" y1="1163.7638" y2="1163.7638"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="226.875" x="389.5833" y="1157.9591">Log access attempt &amp; decision</text><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1816.1458" x2="1864.2708" y1="1214.4849" y2="1214.4849"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1864.2708" x2="1864.2708" y1="1214.4849" y2="1229.3807"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="1817.2917" x2="1864.2708" y1="1229.3807" y2="1229.3807"/><polygon fill="#444444" points="1828.75,1224.7974,1817.2917,1229.3807,1828.75,1233.964,1824.1667,1229.3807" style="stroke:#444444;stroke-width:1.1458333333333333;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="147.8125" x="1824.1667" y="1191.3405">Immutable log entry</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="375.8333" x="1824.1667" y="1208.6802">(user, doc_id, action, context, decision, hash-chain)</text><polygon fill="#444444" points="394.1667,1258.1787,382.7083,1262.762,394.1667,1267.3454,389.5833,1262.762" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="387.2917" x2="1809.2708" y1="1262.762" y2="1262.762"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="104.2708" x="401.0417" y="1256.9573">Log confirmed</text><polygon fill="#444444" points="2205.7292,1291.5601,2217.1875,1296.1434,2205.7292,1300.7267,2210.3125,1296.1434" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="381.5625" x2="2212.6042" y1="1296.1434" y2="1296.1434"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="154.6875" x="389.5833" y="1290.3387">Fetch document {id}</text><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="2230.9375" x2="2279.0625" y1="1346.8644" y2="1346.8644"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="2279.0625" x2="2279.0625" y1="1346.8644" y2="1361.7603"/><line style="stroke:#444444;stroke-width:1.1458333333333333;" x1="2232.0833" x2="2279.0625" y1="1361.7603" y2="1361.7603"/><polygon fill="#444444" points="2243.5417,1357.1769,2232.0833,1361.7603,2243.5417,1366.3436,2238.9583,1361.7603" style="stroke:#444444;stroke-width:1.1458333333333333;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="148.9583" x="2238.9583" y="1323.72">Load encrypted blob</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="209.6875" x="2238.9583" y="1341.0597">Decrypt with per-session key</text><polygon fill="#444444" points="394.1667,1390.5583,382.7083,1395.1416,394.1667,1399.7249,389.5833,1395.1416" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="387.2917" x2="2224.0625" y1="1395.1416" y2="1395.1416"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="226.875" x="401.0417" y="1389.3369">Document content (decrypted)</text><polygon fill="#444444" points="80.2083,1441.2793,68.75,1445.8626,80.2083,1450.446,75.625,1445.8626" style="stroke:#444444;stroke-width:1.1458333333333333;"/><line style="stroke:#444444;stroke-width:1.1458333333333333;stroke-dasharray:2.0,2.0;" x1="73.3333" x2="380.4167" y1="1445.8626" y2="1445.8626"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="52.7083" x="87.0833" y="1422.7183">200 OK</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="286.4583" x="87.0833" y="1440.0579">Content-Type: application/pdf (or JSON)</text><path d="M5.7292,1468.7793 L5.7292,1722.0085 L2288.2292,1722.0085 L2288.2292,1480.2376 L2276.7708,1468.7793 L5.7292,1468.7793 " fill="#F9F9F9" style="stroke:#888888;stroke-width:0.5729166666666666;"/><path d="M2276.7708,1468.7793 L2276.7708,1480.2376 L2288.2292,1480.2376 L2276.7708,1468.7793 " fill="#F9F9F9" style="stroke:#888888;stroke-width:0.5729166666666666;"/><text fill="#000000" font-family="sans-serif" font-size="14.8958" font-weight="bold" lengthAdjust="spacing" textLength="348.3333" x="950.1823" y="1488.3351">Authorization Summary - Successful Flow</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="4.5833" x="950.1823" y="1505.6748">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="113.4375" x="950.1823" y="1523.0145">1. JWT validated</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="205.1042" x="950.1823" y="1540.3542">2. RBAC: role permits "read"</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="182.1875" x="950.1823" y="1557.6938">3. ABAC: all policies pass</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="142.0833" x="963.9323" y="1575.0335">&#8226; Clearance level &#10003;</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="190.2083" x="963.9323" y="1592.3732">&#8226; Time / business hours &#10003;</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="131.7708" x="963.9323" y="1609.7129">&#8226; Network / geo &#10003;</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="370.1042" x="963.9323" y="1627.0526">&#8226; Explicit permission &#10003; (direct share or delegation)</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="206.25" x="950.1823" y="1644.3922">4. Access logged immutably</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="261.25" x="950.1823" y="1661.7319">5. Document decrypted &amp; delivered</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="4.5833" x="950.1823" y="1679.0716">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" font-weight="bold" lengthAdjust="spacing" textLength="173.0208" x="950.1823" y="1696.4113">Typical latency goal:</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="72.1875" x="1127.7865" y="1696.4113">&lt; 120 ms</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" font-weight="bold" lengthAdjust="spacing" textLength="116.875" x="950.1823" y="1713.751">Failure paths:</text><text fill="#000000" font-family="sans-serif" font-size="14.8958" lengthAdjust="spacing" textLength="175.3125" x="1071.6406" y="1713.751">401, 403, 404 with audit</text><!--SRC=[ZLPVQnj747-_Jp5LeDYA95ks0gb80x8i6wUk8YIbfI08gzkLjFNTxh6x9rijXJuL-jg-zgdGB-PFqjdH_PLZaXYYkzsPt_pxpSnznSLAAW7JqN0-65_VZY2CcBL1OE-aIfXXCSHQwN1ZT2nWnI8hAbTsmxY-bshzv8Od4hhTqyh9X1adGvamvIQCSwzqzgfoVw4VylDkzNoidRXWuTtQw5JneOwqWHUhR_pVePGsN9XCulNhrvNhWJ7wFhlfzNf1uAIB10nrd4J22HYaRgED_8KvgHLSHVeUsd2fmpGMoi4W38MrS3Iz60pX9GpmvpW8MEWGhl712jC0Pi4_14aP9JG6ankuPaxSinr9PCy7GcWQPi9iPIX8oX_KHSZkIAsnK2JXtmz03YG6JoGcmiJIMX_U3FtUY_b3UZjqYKi7jtgzpaAZWxfCaPogwtYOlGQ1JmUqt-P1Gn-kHtCuuPcUFVbLyjyMgfRvFbm8Pb3lpRiVvszzXkKMrOl41JaOubBU-l03YoJtCgXHAb0EIQ8YAOnSxS3AjM8kDQ85uY6HXWot07EJOltsEZMtoS92KJpO73969jXqsGAZ8mG98tIPgH0VcNF67WTSrFseUasbxCDm8y8x0cWlcHKSag8yc9AGMFWjD8nWl556HNKdX1BfLZDEGF3unryL68YPC_8X4wy5H4UJmMosK4UacNCuGjxRp6ej338SiCZjTRbGKl00y5yH6bgW3FMXTteELzei9KUvXMhSA9kkLaWSpnPlhq6QN5XdzAwehS01ieTFS00TmhybIYFwQCkYb59BeZhom7QXPkdoPn4wRC-fi3ereV2Tki_aIsoDhJHQUU8HRbaWYimV3RAy5Zs1ngw42pV0aWIji2LcAhS7Ntlo-6S7Qwo-itNOih7ySGdPBWEPv50l8U-9IlbibgDF8DADduR97cENvmJLwAuQJTNO3heurOOvNnSgnO9r2lx2uv__ULSwj04aLgmEgN34Wf7hZOCNj_xd9-49uz6HIo1NPIj0MV7WCowTeKjpYRi5rmZk4gJa2gVgR3ISZkPbPh2hljoDU-asKi4ojJWESMvla0xsStwSen-tUXyodC1Ok7jjxZ9tvkyd7_SkVOaVuvC1e99tvtDMUsXrB0HlEzs-KwXz0gESLxXSC_uyHy_z52c8M6b-xpGcmHO9B72UeUYpD9sE1fU5YMYtPpiEh2DoZvVv-2HN_OLGlDfX9VILL2n2lL1QcltDvcGq_VvctcnYsd4OuGXJEDgrsPLzPx50TYMzuJfcETxgk_nwEXZFHvU7xLJsVMsb-BtdP-eQyqGx7qUwY1E7_PxxUJ0_Q3EI9wHSGRc9uzJHr8WG3sjWTXYNxxcMByj7oLk4uxTFg36f3wvLM6d1XjbDEzmmgOwh-BLGlQEekf8cpWPcRVTurmvZB5TqCT-AyUCtSZsyoaBtvnNbGoZQGqA5PfTuUYmZlLoeIq7lr96Udcqhzloy4xidWBN8YiyBoWp-7d6HOHyV1bhzwdXc9vsTdiBxxnPgk4ThptU9wEU3tPVW9E4hECAkUJTxFtvYeTXHdihK-7gBk1-ebXNppMQTVBCqZXdIjurFnATL6j7NPRCP1DsE_sQ1RVO1muEp3ks__dwTKpUxV1q7vntYRDzlwR8T_AhqpZx-_cyvs24IMn71upz_vrSqO4yE9c9L81jtABCMkden-iHmmMiiXpH-tT8KyDEEYqYiAUhZeDV9FvaZ_mt9GMQji0jUTShI5XMbxeeafXIpW4d4wc1P8eWmBGgdv5gpgDzimXledfr2R57aYia8l-4m0MvZ_LtljDlodnx-lzwUS8mQ06j6i_f_]--></g></svg>